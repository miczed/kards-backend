{"version":3,"sources":["../../js/index.js"],"names":["toolbarOptions","front","Quill","modules","formula","toolbar","theme","back","cardsStore","categoriesStore","cardRef","cardsRef","firebase","database","ref","categoryRef","categoriesRef","on","snapshot","data","val","dataWithKeys","Object","keys","map","key","obj","_key","updateCardsList","children","tree","buildTree","deleteChildren","document","getElementById","buildUlTree","dummy","title","unshift","buildSelectTree","elem","hasChildNodes","removeChild","firstChild","dataMap","forEach","node","parent","push","indent","i","length","createElement","createTextNode","setAttribute","appendChild","ul","button","button_icon","addEventListener","loadCategory","getAttribute","loadCardsByCategory","cards","cardsList","cardsListElem","edit_button","edit_button_icon","loadCard","updateCategoriesList","categoriesList","updateCategoriesSelect","categoryKey","callback","orderByChild","equalTo","once","then","showCardContainer","card","value","category","setContents","front_delta","back_delta","showCategoryContainer","cardContainer","categoryContainer","saveCard","cat","set","getContents","front_html","querySelector","innerHTML","back_html","cardKey","catRef","updatedObj","update","window","alert","initCard","setText","initCategory","deleteCard","answer","confirm","remove","deleteCategory","cardCount","console","log","deletedObjs","hasOwnProperty","cardsRoot","saveCategory","saveCardButton","deleteCardButton","saveCategoryButton","deleteCategoryButton"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * Created by michaelziorjen on 21.11.16.\n */\n\nconst toolbarOptions = [\n    ['bold', 'italic', 'underline', 'strike'],        // toggled buttons\n    ['blockquote', 'code-block'],\n\n    [{ 'list': 'ordered'}, { 'list': 'bullet' }],\n    [{ 'script': 'sub'}, { 'script': 'super' }],      // superscript/subscript\n\n    [{ 'header': [1, 2, false] }],\n\n    [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme\n    [{ 'align': [] }],\n\n    ['formula','image','video'],\n    ['clean'] // clean styling button\n\n];\n\nconst front = new Quill('#front-editor', {\n    modules: { formula: true, toolbar: toolbarOptions },\n    theme: 'snow'\n});\n\nconst back = new Quill('#back-editor', {\n    modules: { formula: true, toolbar: toolbarOptions },\n    theme: 'snow'\n});\n\n\n\n// Global cards store\nlet cardsStore = []; // Stores all cards locally in the browser (later via localstorage)\nlet categoriesStore = []; // Stores all categories locally in the browser (later via localstorage)\nlet cardRef; // The currently selected card\nlet cardsRef = firebase.database().ref('cards'); // The reference to ALL the cards\nlet categoryRef; // The currently selected category\nlet categoriesRef = firebase.database().ref('categories'); // Reference to ALL the categories\n\n/**\n * Called initially and whenever firebase detects a change on a cards object\n */\ncardsRef.on('value', function(snapshot) {\n    let data = snapshot.val();\n    cardsStore = snapshot.val(); // Store returned data in global cards store\n    let dataWithKeys = Object.keys(data).map((key) => {\n        let obj = data[key];\n        obj._key = key;\n        return obj;\n    });\n    updateCardsList(dataWithKeys);\n});\n/**\n * Called initially and whenever firebase detects a change on a category object\n */\ncategoriesRef.on(\"value\", function(snapshot) {\n\n    let data = snapshot.val();\n    categoriesStore = data;\n    let dataWithKeys = [];\n    if(data != null) {\n        dataWithKeys = Object.keys(data).map((key) => {\n            let obj = data[key];\n            obj._key = key;\n            obj.children = [];\n            return obj;\n        });\n    }\n    //updateCategoriesList(dataWithKeys, document.getElementById(\"categories-list\"));\n    let tree = buildTree(dataWithKeys);\n    deleteChildren(document.getElementById(\"categories-list\"));\n    buildUlTree(tree,document.getElementById(\"categories-list\"));\n    const dummy = { _key: \"\", title: \"-- keine Kategorie --\"};\n    dataWithKeys.unshift(dummy);\n\n    deleteChildren(document.getElementById(\"card-category\"));\n    buildSelectTree(tree,document.getElementById(\"card-category\"),\"\");\n\n    deleteChildren(document.getElementById(\"category-parent\"));\n    buildSelectTree(tree,document.getElementById(\"category-parent\"),\"\");\n\n});\n\n/**\n * helper function to remove all children inside a DOM element\n * @param elem : Element whose children should be removed\n */\nfunction deleteChildren(elem) {\n    while (elem.hasChildNodes()) {\n        elem.removeChild(elem.firstChild);\n    }\n}\n\n\n/**\n * Builds a tree from a flat array\n * @pre data objects must have empty children property children\n * @pre data objects parent property must point to the key of the parent or be empty\n * @param data : Array of objects\n * @returns Array\n */\nfunction buildTree(data) {\n    var dataMap = {};\n    data.forEach(function(node) {\n        dataMap[node._key] = node;\n    });\n\n    // create the tree array\n    var tree = [];\n    data.forEach(function(node) {\n        // find parent\n        var parent = dataMap[node.parent];\n        if (parent) {\n            // create child array if it doesn't exist\n            (parent.children || (parent.children = []))\n            // add node to parent's child array\n                .push(node);\n        } else {\n            // parent is null or missing\n            tree.push(node);\n        }\n    });\n    return tree;\n}\n/**\n * Renders a SELECT tree recursively\n * @param obj : object that should be rendered (must be a tree with children attribute)\n * @param elem : Element in which the object should be rendered\n * @param indent : string that is in the beginning of the title output\n */\nfunction buildSelectTree(obj,elem,indent) {\n    if(!obj) { return; }\n\n    for(let i = 0; i < obj.length; i++) {\n        let node = document.createElement(\"OPTION\");\n        let title = document.createTextNode(indent + \" \" + obj[i].title);\n        node.setAttribute(\"value\",obj[i]._key);\n        node.appendChild(title);\n        elem.appendChild(node);\n        if(obj[i].children) {\n            buildSelectTree(obj[i].children,elem,indent + \"--\");\n        }\n    }\n}\n\n/**\n * Renders a UL - LI tree recursively\n * @param obj : object that should be rendered (should be a tree with children attribute)\n * @param elem : Element in which the object should be rendered\n */\nfunction buildUlTree(obj, elem) {\n    if(!obj) { return; }\n    let ul = document.createElement(\"UL\");\n\n    for(let i=0; i < obj.length; i++) {\n        let node = document.createElement(\"LI\");\n        let title = document.createTextNode(obj[i].title);\n        let button = document.createElement(\"BUTTON\");\n        let button_icon = document.createElement(\"SPAN\");\n        button_icon.setAttribute(\"class\",\"icon-pencil\");\n        button.appendChild(button_icon);\n\n        button.setAttribute(\"data-key\", obj[i]._key);\n        node.setAttribute(\"data-key\", obj[i]._key);\n        button.setAttribute(\"class\",\"transparent\");\n        node.appendChild(title);\n        node.appendChild(button);\n\n        button.addEventListener(\"click\", function () {\n            loadCategory(this.getAttribute(\"data-key\"));\n            return true;\n        });\n\n        node.addEventListener(\"click\", function () {\n            loadCardsByCategory(this.getAttribute(\"data-key\"),(cards) => { updateCardsList(cards)});\n            return true;\n        });\n\n        if(obj[i].children) {\n            buildUlTree(obj[i].children, node);\n        }\n\n        ul.appendChild(node);\n    }\n    elem.appendChild(ul);\n}\n\n/**\n * Updates all dom elements which contain a list of cards\n * @param cardsList : Array with cards\n */\nfunction updateCardsList(cardsList) {\n    const cardsListElem = document.getElementById(\"cards-list\");\n    while (cardsListElem.hasChildNodes()) {\n        cardsListElem.removeChild(cardsListElem.firstChild);\n    }\n\n    for(let i = 0; i < cardsList.length; i++) {\n        let node = document.createElement(\"LI\");\n        let title = document.createTextNode(cardsList[i].title);\n        let edit_button = document.createElement(\"BUTTON\");\n        let edit_button_icon = document.createElement(\"SPAN\");\n        edit_button_icon.setAttribute(\"class\",\"icon-pencil\");\n        edit_button.appendChild(edit_button_icon);\n        node.setAttribute(\"data-key\", cardsList[i]._key);\n\n        edit_button.setAttribute(\"data-key\", cardsList[i]._key);\n        edit_button.setAttribute(\"class\",\"transparent\");\n        node.appendChild(title);\n        node.appendChild(edit_button);\n\n        edit_button.addEventListener(\"click\",function() {\n           loadCard(this.getAttribute(\"data-key\"));\n           return true;\n        });\n\n        node.addEventListener(\"click\",function() {\n            loadCard(this.getAttribute(\"data-key\"));\n            return true;\n        });\n\n        cardsListElem.appendChild(node);\n    }\n}\n\n/**\n * Updates a single UL DOM element with the list of categories\n * @param categoriesList : Array\n * @param elem Element (UL)\n */\nfunction updateCategoriesList(categoriesList, elem) {\n    if(elem) {\n        while (elem.hasChildNodes()) {\n            elem.removeChild(elem.firstChild);\n        }\n        for (let i = 0; i < categoriesList.length; i++) {\n            let node = document.createElement(\"LI\");\n            let title = document.createTextNode(categoriesList[i].title);\n            let button = document.createElement(\"BUTTON\");\n            let button_icon = document.createElement(\"SPAN\");\n            button_icon.setAttribute(\"class\",\"icon-pencil\");\n            button.appendChild(button_icon);\n\n            button.setAttribute(\"data-key\", categoriesList[i]._key);\n            button.setAttribute(\"class\",\"transparent\");\n            node.appendChild(title);\n            node.appendChild(button);\n\n            button.addEventListener(\"click\", function () {\n                loadCategory(this.getAttribute(\"data-key\"));\n                return true;\n            });\n            elem.appendChild(node);\n        }\n    }\n}\n/**\n * Updates a single SELECT DOM element with the list of categories\n * @param categoriesList : Array\n * @param elem : Element SELECT DOM element\n */\nfunction updateCategoriesSelect(categoriesList, elem) {\n    if(elem) {\n        while (elem.hasChildNodes()) {\n            elem.removeChild(elem.firstChild);\n        }\n        for(let i = 0; i < categoriesList.length; i++) {\n            let node = document.createElement(\"OPTION\");\n            let title = document.createTextNode(categoriesList[i].title);\n            node.setAttribute(\"value\",categoriesList[i]._key);\n            node.appendChild(title);\n            elem.appendChild(node);\n        }\n    }\n}\n/**\n * Gets the cards from firebase that belong to the specified category\n * @param categoryKey : String\n * @param callback : Function which gets executed, when the promise is resolved\n * @return Array list of cards\n */\nfunction loadCardsByCategory(categoryKey,callback) {\n    firebase.database().ref('cards').orderByChild('category').equalTo(categoryKey).once('value').then(function(snapshot) {\n        if(snapshot.val()) {\n            let data = snapshot.val();\n            cardsStore = snapshot.val(); // Store returned data in global cards store\n            let dataWithKeys = Object.keys(data).map((key) => {\n                let obj = data[key];\n                obj._key = key;\n                return obj;\n            });\n            callback(dataWithKeys);\n        }\n    });\n}\n\n/**\n * Loads the card into the corresponding DOM fields and prepares it for editing\n * @param key: String the firebase key of the card\n */\nfunction loadCard(key) {\n    showCardContainer();\n    let card = cardsStore[key];\n    cardRef = firebase.database().ref('cards/' + key);\n    document.getElementById(\"card-title\").value = card.title;\n    document.getElementById(\"card-category\").value = card.category;\n    front.setContents(card.front_delta);\n    back.setContents(card.back_delta);\n}\n\n/**\n * Loads the category into the corresponding DOM fields and prepares it for editing\n * @param key: String the firebase key of the category\n */\nfunction loadCategory(key) {\n    showCategoryContainer()\n    let category = categoriesStore[key];\n    categoryRef = firebase.database().ref('categories/' + key);\n    document.getElementById(\"category-title\").value = category.title;\n    document.getElementById(\"category-parent\").value = category.parent;\n}\n/**\n * Shows the card container and hides the categories container\n */\nfunction showCardContainer() {\n    const cardContainer = document.getElementById(\"card\");\n    const categoryContainer = document.getElementById(\"category\");\n    if(cardContainer.getAttribute(\"class\") == \"hide\") {\n        cardContainer.setAttribute(\"class\",\"show\");\n    }\n    if(categoryContainer.getAttribute(\"class\") == \"show\") {\n        categoryContainer.setAttribute(\"class\",\"hide\");\n    }\n}\n\n/**\n * Shows the category container and hides the card container\n */\nfunction showCategoryContainer() {\n    const cardContainer = document.getElementById(\"card\");\n    const categoryContainer = document.getElementById(\"category\");\n    if(cardContainer.getAttribute(\"class\") == \"show\") {\n        cardContainer.setAttribute(\"class\",\"hide\");\n    }\n    if(categoryContainer.getAttribute(\"class\") == \"hide\") {\n        categoryContainer.setAttribute(\"class\",\"show\");\n    }\n}\n\n/**\n * Saves the currently loaded card to firebase. Works both with update and create\n * @pre: cardRef has to be set if card should be updated, otherwise a new card is created\n * @post: cardRef is set to the updated / created card\n */\nfunction saveCard() {\n    const title = document.getElementById(\"card-title\").value;\n    const cat = document.getElementById(\"card-category\").value;\n    if(title && cat) {\n        if(cardRef == null) { // Neue Karte wird erstellt\n            cardRef = firebase.database().ref('cards').push()\n        }\n        cardRef.set({\n            front_delta: front.getContents(),\n            front_html: document.querySelector(\"#front-editor .ql-editor\").innerHTML,\n            back_delta: back.getContents(),\n            back_html: document.querySelector(\"#back-editor .ql-editor\").innerHTML,\n            title: title,\n            category: cat\n        });\n\n        // Set cards obj in categories\n        const cardKey = cardRef.key;\n        const catRef = firebase.database().ref(\"categories/\" + cat + \"/cards/\" + cardKey);\n        let updatedObj = {};\n        updatedObj[cardKey] = true;\n        catRef.update(updatedObj);\n\n        cardRef = firebase.database().ref('cards/' + cardRef.key);\n    } else {\n        window.alert(\"Bitte gib einen Titel und eine Kategorie für die Karte an.\");\n    }\n}\n/**\n * Resets the DOM fields and the cardRef so a new blank card can be created\n * @post: cardRef points to null\n */\nfunction initCard() {\n    showCardContainer();\n    cardRef = null;\n    document.getElementById(\"card-title\").value = \"\";\n    document.getElementById(\"card-category\").value = \"\";\n    front.setText(\"\");\n    back.setText(\"\");\n}\n/**\n * Resets the DOM fields and the categoryRef so a new blank category can be created\n * @post: categoryRef points to null\n */\nfunction initCategory() {\n    showCategoryContainer();\n    categoryRef = null;\n    document.getElementById(\"category-title\").value = \"\";\n    document.getElementById(\"category-parent\").value = \"\";\n}\n\n/**\n * The currently loaded card is deleted\n * @pre: cardRef should point to the card that should be deleted\n * @post: cardRef is set to null\n */\nfunction deleteCard() {\n    if(cardRef != null) {\n        const cardKey = cardRef.key;\n        const cat = cardsStore[cardKey].category;\n        const card = cardsStore[cardKey];\n        let answer = window.confirm(\"Möchtest du die Karte \" + card.title + \" wirklich löschen?\");\n        if(answer == true ) {\n            let catRef = firebase.database().ref(\"categories/\" + cat + \"/cards/\" + cardKey);\n            let updatedObj = {};\n            updatedObj[cardKey] = null;\n            catRef.update(updatedObj);\n            cardRef.remove();\n            initCard();\n        }\n    } else {\n        window.alert(\"Bitte wähle eine Karte aus, welche du löschen willst.\");\n    }\n}\n/**\n * The currently loaded category and ALL it's cards are deleted\n * @pre: categoryRef should point to the card that should be deleted\n * @post: categoryRef is set to null\n */\nfunction deleteCategory() {\n    if(categoryRef != null) {\n\n        const cat = categoriesStore[categoryRef.key];\n        let cardCount;\n        if(cat.cards) {\n            console.log(cat.cards);\n            cardCount = Object.keys(cat.cards).length;\n        } else {\n            cardCount = 0;\n        }\n        let answer = window.confirm(\"Möchtest du die Kategorie \" + cat.title + \" und ALLE ihre \" + cardCount +\" zugeordneten Karten wirklich löschen?\");\n        if(answer == true) {\n            let deletedObjs = {}\n            for (let key in cat.cards) {\n                if (cat.cards.hasOwnProperty(key)) {\n                    deletedObjs[key] = null;\n                }\n            }\n            let cardsRoot = firebase.database().ref(\"cards\");\n            console.log(deletedObjs);\n            cardsRoot.update(deletedObjs);\n            categoryRef.remove();\n            initCategory();\n        }\n    } else {\n        window.alert(\"Bitte wähle eine Kategorie aus, welche du löschen willst.\");\n    }\n}\n\n/**\n * Saves the currently loaded category to firebase. Works both with update and create\n * @pre: categoryRef has to be set if category should be updated, otherwise a new category is created\n * @post: categoryRef is set to the updated / created category\n */\nfunction saveCategory() {\n    const title = document.getElementById(\"category-title\").value;\n    let parent = document.getElementById(\"category-parent\").value;\n    if(parent == '') {\n        parent = null;\n    }\n    if(title) {\n        if(categoryRef && categoryRef.key == parent) {\n            window.alert(\"Die Kategorie kann sich nicht selbst als Oberkategorie haben.\");\n            return;\n        }\n        if(categoryRef == null) {\n            categoryRef = firebase.database().ref('categories').push();\n        }\n\n        let updatedObj = {};\n        updatedObj[\"title\"] = title;\n        updatedObj[\"parent\"] = parent;\n        categoryRef.update(updatedObj);\n        categoryRef = firebase.database().ref('categories/' + categoryRef.key);\n\n    } else {\n        window.alert(\"Bitte gib einen Titel für die Kategorie an.\");\n    }\n\n\n}\n\n/* Listener attachments */\nconst saveCardButton = document.getElementById(\"card-controls-save\");\nsaveCardButton.addEventListener(\"click\", saveCard);\n\ndocument.getElementById(\"card-controls-new\").addEventListener(\"click\", initCard);\ndocument.getElementById(\"cards-new\").addEventListener(\"click\", initCard);\n\ndocument.getElementById(\"category-controls-new\").addEventListener(\"click\", initCategory);\ndocument.getElementById(\"categories-new\").addEventListener(\"click\", initCategory);\n\nconst deleteCardButton = document.getElementById(\"card-controls-delete\");\ndeleteCardButton.addEventListener(\"click\", deleteCard);\n\nconst saveCategoryButton = document.getElementById(\"category-controls-save\");\nsaveCategoryButton.addEventListener(\"click\", saveCategory);\n\nconst deleteCategoryButton = document.getElementById(\"category-controls-delete\");\ndeleteCategoryButton.addEventListener(\"click\", deleteCategory);\n"]}