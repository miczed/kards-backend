{"version":3,"sources":["../../js/index.js"],"names":["toolbarOptions","front","Quill","modules","formula","toolbar","theme","back","cardsProvider","Cards","firebase","categoriesProvider","Categories","getCategoryProgressGroups","joint","console","log","cardsStore","categoriesStore","cardRef","cardsRef","database","ref","categoryRef","categoriesRef","on","snapshot","data","val","dataWithKeys","Object","keys","map","key","obj","_key","updateCardsList","children","tree","buildTree","deleteChildren","document","getElementById","buildUlTree","updateCategoriesSelect","elem","hasChildNodes","removeChild","firstChild","dataMap","forEach","node","parent","push","buildSelectTree","indent","i","length","createElement","title","createTextNode","setAttribute","appendChild","category","ul","cardCount","cards","button","button_icon","pill","pill_text","addEventListener","loadCategory","getAttribute","loadCardsByCategory","cardsList","cardsListElem","edit_button","edit_button_icon","loadCard","updateCategoriesList","categoriesList","categoryKey","callback","orderByChild","equalTo","once","then","showCardContainer","card","value","setContents","front_delta","back_delta","showCategoryContainer","cardContainer","categoryContainer","saveCard","cat","oldCategory","remove","set","getContents","front_html","querySelector","innerHTML","back_html","cardKey","catRef","updatedObj","update","window","alert","initCard","event","setText","initCategory","deleteCard","answer","confirm","deleteCategory","deletedObjs","hasOwnProperty","cardsRoot","saveCategory","saveCardButton","deleteCardButton","saveCategoryButton","deleteCategoryButton"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * Created by michaelziorjen on 21.11.16.\n */\n\nconst toolbarOptions = [\n    ['bold', 'italic', 'underline', 'strike'],        // toggled buttons\n    ['blockquote', 'code-block'],\n\n    [{ 'list': 'ordered'}, { 'list': 'bullet' }],\n    [{ 'script': 'sub'}, { 'script': 'super' }],      // superscript/subscript\n\n    [{ 'header': [1, 2, false] }],\n\n    [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme\n\n    ['formula','image','video'],\n    ['clean'] // clean styling button\n\n];\n\nconst front = new Quill('#front-editor', {\n    modules: { formula: true, toolbar: toolbarOptions },\n    theme: 'snow'\n});\n\nconst back = new Quill('#back-editor', {\n    modules: { formula: true, toolbar: toolbarOptions },\n    theme: 'snow'\n});\n\n\nlet cardsProvider = new Cards(firebase);\nlet categoriesProvider = new Categories(firebase);\n\ncategoriesProvider.getCategoryProgressGroups('-KYKBbjT6cBqAbFY87AV',(joint) => { // //-KXuyoLUPxH-XGIDZkIY\n    console.log(joint);\n});\n\n// Global cards store\nlet cardsStore = []; // Stores all cards locally in the browser (later via localstorage)\nlet categoriesStore = []; // Stores all categories locally in the browser (later via localstorage)\nlet cardRef; // The currently selected card\nlet cardsRef = firebase.database().ref('cards'); // The reference to ALL the cards\nlet categoryRef; // The currently selected category\nlet categoriesRef = firebase.database().ref('categories'); // Reference to ALL the categories\n\n/**\n * Called initially and whenever firebase detects a change on a cards object\n */\ncardsRef.on('value', function(snapshot) {\n    let data = snapshot.val();\n    cardsStore = snapshot.val(); // Store returned data in global cards store\n    let dataWithKeys = Object.keys(data).map((key) => {\n        let obj = data[key];\n        obj._key = key;\n        return obj;\n    });\n    updateCardsList(dataWithKeys);\n});\n/**\n * Called initially and whenever firebase detects a change on a category object\n */\ncategoriesRef.on(\"value\", function(snapshot) {\n\n    let data = snapshot.val();\n    categoriesStore = data;\n    let dataWithKeys = [];\n    if(data != null) {\n        dataWithKeys = Object.keys(data).map((key) => {\n            let obj = data[key];\n            obj._key = key;\n            obj.children = [];\n            return obj;\n        });\n    }\n    //updateCategoriesList(dataWithKeys, document.getElementById(\"categories-list\"));\n    let tree = buildTree(dataWithKeys);\n    deleteChildren(document.getElementById(\"categories-list\"));\n    buildUlTree(tree,document.getElementById(\"categories-list\"));\n\n    updateCategoriesSelect(tree,document.getElementById(\"card-category\"));\n    updateCategoriesSelect(tree,document.getElementById(\"category-parent\"));\n\n});\n\n/**\n * helper function to remove all children inside a DOM element\n * @param elem : Element whose children should be removed\n */\nfunction deleteChildren(elem) {\n    while (elem.hasChildNodes()) {\n        elem.removeChild(elem.firstChild);\n    }\n}\n\n\n/**\n * Builds a tree from a flat array\n * @pre data objects must have empty children property children\n * @pre data objects parent property must point to the key of the parent or be empty\n * @param data : Array of objects\n * @returns Array\n */\nfunction buildTree(data) {\n    var dataMap = {};\n    data.forEach(function(node) {\n        dataMap[node._key] = node;\n    });\n\n    // create the tree array\n    var tree = [];\n    data.forEach(function(node) {\n        // find parent\n        var parent = dataMap[node.parent];\n        if (parent) {\n            // create child array if it doesn't exist\n            (parent.children || (parent.children = []))\n            // add node to parent's child array\n                .push(node);\n        } else {\n            // parent is null or missing\n            tree.push(node);\n        }\n    });\n    return tree;\n}\n/**\n * Renders a SELECT tree recursively\n * @param obj : object that should be rendered (must be a tree with children attribute)\n * @param elem : Element in which the object should be rendered\n * @param indent : string that is in the beginning of the title output\n */\nfunction buildSelectTree(obj,elem,indent) {\n    if(!obj) { return; }\n\n    for(let i = 0; i < obj.length; i++) {\n        let node = document.createElement(\"OPTION\");\n        let title = document.createTextNode(indent + \" \" + obj[i].title);\n        node.setAttribute(\"value\",obj[i]._key);\n        node.appendChild(title);\n        elem.appendChild(node);\n        if(cardRef && obj[i]._key == cardsStore[cardRef.key].category) {\n            node.setAttribute(\"selected\",\"selected\");\n        }\n        if(obj[i].children) {\n            buildSelectTree(obj[i].children,elem,indent + \"--\");\n        }\n    }\n}\n\n/**\n * Renders a UL - LI tree recursively\n * @param obj : object that should be rendered (should be a tree with children attribute)\n * @param elem : Element in which the object should be rendered\n */\nfunction buildUlTree(obj, elem) {\n    if(!obj) { return; }\n    let ul = document.createElement(\"UL\");\n\n    for(let i=0; i < obj.length; i++) {\n        let node = document.createElement(\"LI\");\n        let cardCount = 0;\n        if(obj[i].cards) {\n            cardCount = Object.keys(obj[i].cards).length;\n        }\n        let title = document.createTextNode(obj[i].title);\n\n\n        let button = document.createElement(\"BUTTON\");\n        let button_icon = document.createElement(\"SPAN\");\n        button_icon.setAttribute(\"class\",\"icon-pencil\");\n        button.appendChild(button_icon);\n\n        button.setAttribute(\"data-key\", obj[i]._key);\n        node.setAttribute(\"data-key\", obj[i]._key);\n        button.setAttribute(\"class\",\"transparent\");\n        node.appendChild(title);\n\n        node.appendChild(button);\n\n        if(obj[i].children && obj[i].children.length == 0) {\n            let pill = document.createElement(\"SPAN\");\n            let pill_text = document.createTextNode(cardCount);\n            pill.appendChild(pill_text);\n            pill.setAttribute(\"class\", \"pill\");\n            node.appendChild(pill);\n        }\n\n\n        button.addEventListener(\"click\", function () {\n            loadCategory(this.getAttribute(\"data-key\"));\n            return true;\n        });\n\n        node.addEventListener(\"click\", function () {\n            loadCardsByCategory(this.getAttribute(\"data-key\"),(cards) => { updateCardsList(cards)});\n            return true;\n        });\n\n        if(obj[i].children) {\n            buildUlTree(obj[i].children, node);\n        }\n\n        ul.appendChild(node);\n    }\n    elem.appendChild(ul);\n}\n\n/**\n * Updates all dom elements which contain a list of cards\n * @param cardsList : Array with cards\n */\nfunction updateCardsList(cardsList) {\n    const cardsListElem = document.getElementById(\"cards-list\");\n    while (cardsListElem.hasChildNodes()) {\n        cardsListElem.removeChild(cardsListElem.firstChild);\n    }\n\n    for(let i = 0; i < cardsList.length; i++) {\n        let node = document.createElement(\"LI\");\n        let title = document.createTextNode(cardsList[i].title);\n        let edit_button = document.createElement(\"BUTTON\");\n        let edit_button_icon = document.createElement(\"SPAN\");\n        edit_button_icon.setAttribute(\"class\",\"icon-pencil\");\n        edit_button.appendChild(edit_button_icon);\n        node.setAttribute(\"data-key\", cardsList[i]._key);\n\n        edit_button.setAttribute(\"data-key\", cardsList[i]._key);\n        edit_button.setAttribute(\"class\",\"transparent\");\n        node.appendChild(title);\n        node.appendChild(edit_button);\n\n        edit_button.addEventListener(\"click\",function() {\n           loadCard(this.getAttribute(\"data-key\"));\n           return true;\n        });\n\n        node.addEventListener(\"click\",function() {\n            loadCard(this.getAttribute(\"data-key\"));\n            return true;\n        });\n\n        cardsListElem.appendChild(node);\n    }\n}\n\n/**\n * Updates a single UL DOM element with the list of categories\n * @param categoriesList : Array\n * @param elem Element (UL)\n */\nfunction updateCategoriesList(categoriesList, elem) {\n    if(elem) {\n        while (elem.hasChildNodes()) {\n            elem.removeChild(elem.firstChild);\n        }\n        for (let i = 0; i < categoriesList.length; i++) {\n            let node = document.createElement(\"LI\");\n            let title = document.createTextNode(categoriesList[i].title);\n            let button = document.createElement(\"BUTTON\");\n            let button_icon = document.createElement(\"SPAN\");\n            button_icon.setAttribute(\"class\",\"icon-pencil\");\n            button.appendChild(button_icon);\n\n            button.setAttribute(\"data-key\", categoriesList[i]._key);\n            button.setAttribute(\"class\",\"transparent\");\n            node.appendChild(title);\n            node.appendChild(button);\n\n            button.addEventListener(\"click\", function () {\n                loadCategory(this.getAttribute(\"data-key\"));\n                return true;\n            });\n            elem.appendChild(node);\n        }\n    }\n}\n/**\n * Updates a single SELECT DOM element with the list of categories\n * @param categoriesList : Array\n * @param elem : Element SELECT DOM element\n */\nfunction updateCategoriesSelect(categoriesList, elem) {\n    if(elem) {\n        while (elem.hasChildNodes()) {\n            elem.removeChild(elem.firstChild);\n        }\n        // Add empty node on top\n        let node = document.createElement(\"OPTION\");\n        let title = document.createTextNode(\"-- nichts ausgewählt --\");\n        node.appendChild(title);\n        node.setAttribute(\"value\",\"\");\n        elem.appendChild(node);\n\n        buildSelectTree(categoriesList,elem,\"\");\n\n    }\n}\n/**\n * Gets the cards from firebase that belong to the specified category\n * @param categoryKey : String\n * @param callback : Function which gets executed, when the promise is resolved\n * @return Array list of cards\n */\nfunction loadCardsByCategory(categoryKey,callback) {\n    firebase.database().ref('cards').orderByChild('category').equalTo(categoryKey).once('value').then(function(snapshot) {\n        if(snapshot.val()) {\n            let data = snapshot.val();\n            cardsStore = snapshot.val(); // Store returned data in global cards store\n            let dataWithKeys = Object.keys(data).map((key) => {\n                let obj = data[key];\n                obj._key = key;\n                return obj;\n            });\n            callback(dataWithKeys);\n        }\n    });\n}\n\n/**\n * Loads the card into the corresponding DOM fields and prepares it for editing\n * @param key: String the firebase key of the card\n */\nfunction loadCard(key) {\n    showCardContainer();\n    let card = cardsStore[key];\n    cardRef = firebase.database().ref('cards/' + key);\n    document.getElementById(\"card-title\").value = card.title;\n    document.getElementById(\"card-category\").value = card.category;\n    front.setContents(card.front_delta);\n    back.setContents(card.back_delta);\n}\n\n/**\n * Loads the category into the corresponding DOM fields and prepares it for editing\n * @param key: String the firebase key of the category\n */\nfunction loadCategory(key) {\n    showCategoryContainer()\n    let category = categoriesStore[key];\n    categoryRef = firebase.database().ref('categories/' + key);\n    document.getElementById(\"category-title\").value = category.title;\n    document.getElementById(\"category-parent\").value = category.parent;\n}\n/**\n * Shows the card container and hides the categories container\n */\nfunction showCardContainer() {\n    const cardContainer = document.getElementById(\"card\");\n    const categoryContainer = document.getElementById(\"category\");\n    if(cardContainer.getAttribute(\"class\") == \"hide\") {\n        cardContainer.setAttribute(\"class\",\"show\");\n    }\n    if(categoryContainer.getAttribute(\"class\") == \"show\") {\n        categoryContainer.setAttribute(\"class\",\"hide\");\n    }\n}\n\n/**\n * Shows the category container and hides the card container\n */\nfunction showCategoryContainer() {\n    const cardContainer = document.getElementById(\"card\");\n    const categoryContainer = document.getElementById(\"category\");\n    if(cardContainer.getAttribute(\"class\") == \"show\") {\n        cardContainer.setAttribute(\"class\",\"hide\");\n    }\n    if(categoryContainer.getAttribute(\"class\") == \"hide\") {\n        categoryContainer.setAttribute(\"class\",\"show\");\n    }\n}\n\n/**\n * Saves the currently loaded card to firebase. Works both with update and create\n * @pre: cardRef has to be set if card should be updated, otherwise a new card is created\n * @post: cardRef is set to the updated / created card\n */\nfunction saveCard() {\n    const title = document.getElementById(\"card-title\").value;\n    const cat = document.getElementById(\"card-category\").value;\n    if(title && cat) {\n        if(cardRef == null) { // Neue Karte wird erstellt\n            cardRef = firebase.database().ref('cards').push()\n        }\n\n        // Delete from old category when category is changed\n        if(cardsStore[cardRef.key]) {\n            const oldCategory = cardsStore[cardRef.key].category;\n            if(oldCategory != cat) {\n                firebase.database().ref('categories/' + oldCategory + \"/cards/\" + cardRef.key).remove();\n            }\n        }\n\n        cardRef.set({\n            front_delta: front.getContents(),\n            front_html: document.querySelector(\"#front-editor .ql-editor\").innerHTML,\n            back_delta: back.getContents(),\n            back_html: document.querySelector(\"#back-editor .ql-editor\").innerHTML,\n            title: title,\n            category: cat\n        }).then(()=> {\n            // TODO: add some sort of notification\n        });\n\n        // Set cards obj in categories\n        const cardKey = cardRef.key;\n        const catRef = firebase.database().ref(\"categories/\" + cat + \"/cards/\" + cardKey);\n        let updatedObj = {};\n        updatedObj[cardKey] = true;\n        catRef.update(updatedObj);\n\n        cardRef = firebase.database().ref('cards/' + cardRef.key);\n    } else {\n        window.alert(\"Bitte gib einen Titel und eine Kategorie für die Karte an.\");\n    }\n}\n/**\n * Resets the DOM fields and the cardRef so a new blank card can be created\n * @post: cardRef points to null\n */\nfunction initCard(event) {\n    showCardContainer();\n    cardRef = null;\n\n    document.getElementById(\"card-category\").value = \"\";\n    document.getElementById(\"card-title\").value = \"\";\n\n    front.setText(\"\");\n    back.setText(\"\");\n}\n/**\n * Resets the DOM fields and the categoryRef so a new blank category can be created\n * @post: categoryRef points to null\n */\nfunction initCategory() {\n    showCategoryContainer();\n    categoryRef = null;\n    document.getElementById(\"category-title\").value = \"\";\n    document.getElementById(\"category-parent\").value = \"\";\n}\n\n/**\n * The currently loaded card is deleted\n * @pre: cardRef should point to the card that should be deleted\n * @post: cardRef is set to null\n */\nfunction deleteCard() {\n    if(cardRef != null) {\n        const cardKey = cardRef.key;\n        const cat = cardsStore[cardKey].category;\n        const card = cardsStore[cardKey];\n        let answer = window.confirm(\"Möchtest du die Karte \" + card.title + \" wirklich löschen?\");\n        if(answer == true ) {\n            let catRef = firebase.database().ref(\"categories/\" + cat + \"/cards/\" + cardKey);\n            let updatedObj = {};\n            updatedObj[cardKey] = null;\n            catRef.update(updatedObj);\n            cardRef.remove();\n            initCard();\n        }\n    } else {\n        window.alert(\"Bitte wähle eine Karte aus, welche du löschen willst.\");\n    }\n}\n/**\n * The currently loaded category and ALL it's cards are deleted\n * @pre: categoryRef should point to the card that should be deleted\n * @post: categoryRef is set to null\n */\nfunction deleteCategory() {\n    if(categoryRef != null) {\n\n        const cat = categoriesStore[categoryRef.key];\n        let cardCount;\n        if(cat.cards) {\n            console.log(cat.cards);\n            cardCount = Object.keys(cat.cards).length;\n        } else {\n            cardCount = 0;\n        }\n        let answer = window.confirm(\"Möchtest du die Kategorie \" + cat.title + \" und ALLE ihre \" + cardCount +\" zugeordneten Karten wirklich löschen?\");\n        if(answer == true) {\n            let deletedObjs = {}\n            for (let key in cat.cards) {\n                if (cat.cards.hasOwnProperty(key)) {\n                    deletedObjs[key] = null;\n                }\n            }\n            let cardsRoot = firebase.database().ref(\"cards\");\n            console.log(deletedObjs);\n            cardsRoot.update(deletedObjs);\n            categoryRef.remove();\n            initCategory();\n        }\n    } else {\n        window.alert(\"Bitte wähle eine Kategorie aus, welche du löschen willst.\");\n    }\n}\n\n/**\n * Saves the currently loaded category to firebase. Works both with update and create\n * @pre: categoryRef has to be set if category should be updated, otherwise a new category is created\n * @post: categoryRef is set to the updated / created category\n */\nfunction saveCategory() {\n    const title = document.getElementById(\"category-title\").value;\n    let parent = document.getElementById(\"category-parent\").value;\n    if(parent == '') {\n        parent = null;\n    }\n    if(title) {\n        if(categoryRef && categoryRef.key == parent) {\n            window.alert(\"Die Kategorie kann sich nicht selbst als Oberkategorie haben.\");\n            return;\n        }\n        if(categoryRef == null) {\n            categoryRef = firebase.database().ref('categories').push();\n        }\n\n        let updatedObj = {};\n        updatedObj[\"title\"] = title;\n        updatedObj[\"parent\"] = parent;\n        categoryRef.update(updatedObj);\n        categoryRef = firebase.database().ref('categories/' + categoryRef.key);\n\n    } else {\n        window.alert(\"Bitte gib einen Titel für die Kategorie an.\");\n    }\n\n\n}\n\n/* Listener attachments */\nconst saveCardButton = document.getElementById(\"card-controls-save\");\nsaveCardButton.addEventListener(\"click\", saveCard);\n\ndocument.getElementById(\"card-controls-new\").addEventListener(\"click\", initCard);\ndocument.getElementById(\"cards-new\").addEventListener(\"click\", initCard);\n\ndocument.getElementById(\"category-controls-new\").addEventListener(\"click\", initCategory);\ndocument.getElementById(\"categories-new\").addEventListener(\"click\", initCategory);\n\nconst deleteCardButton = document.getElementById(\"card-controls-delete\");\ndeleteCardButton.addEventListener(\"click\", deleteCard);\n\nconst saveCategoryButton = document.getElementById(\"category-controls-save\");\nsaveCategoryButton.addEventListener(\"click\", saveCategory);\n\nconst deleteCategoryButton = document.getElementById(\"category-controls-delete\");\ndeleteCategoryButton.addEventListener(\"click\", deleteCategory);\n"]}